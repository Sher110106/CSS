2025-10-26 13:03:00,821 - preprocessing_main - INFO - ============================================================
2025-10-26 13:03:00,822 - preprocessing_main - INFO - Starting Data Preprocessing
2025-10-26 13:03:00,822 - preprocessing_main - INFO - ============================================================
2025-10-26 13:03:00,822 - preprocessing_main - INFO - Loading raw data...
2025-10-26 13:03:00,970 - preprocessing_main - INFO - Loaded 1337 posts and 32909 comments
2025-10-26 13:03:01,244 - preprocessing_main - INFO - 
Processing posts...
2025-10-26 13:03:14,159 - preprocessing_main - INFO - 
Processing comments...
2025-10-26 13:05:10,527 - preprocessing_main - INFO - 
Combining posts and comments...
2025-10-26 13:05:10,540 - preprocessing_main - INFO - Combined dataset: 19204 documents
2025-10-26 13:05:10,540 - preprocessing_main - INFO - 
Saving processed data...
2025-10-26 13:05:11,695 - preprocessing_main - INFO - Saved processed dataframes
2025-10-26 13:05:11,695 - preprocessing_main - INFO - 
Creating corpus for topic modeling...
2025-10-26 13:05:11,844 - preprocessing_main - INFO - Saved corpus: 19204 documents
2025-10-26 13:05:11,844 - preprocessing_main - INFO - 
Generating preprocessing report...
2025-10-26 13:05:11,961 - preprocessing_main - ERROR - Preprocessing failed: Object of type int64 is not JSON serializable
2025-10-26 13:05:11,962 - preprocessing_main - ERROR - Traceback (most recent call last):
  File "/Users/sher/project/css/semaglutide-reddit-analysis/scripts/02_data_preprocessing.py", line 465, in main
    report = generate_preprocessing_report(
        pd.concat([posts_df, comments_df], ignore_index=True),
    ...<2 lines>...
        'data/metadata/preprocessing_report.json'
    )
  File "/Users/sher/project/css/semaglutide-reddit-analysis/scripts/02_data_preprocessing.py", line 311, in generate_preprocessing_report
    save_json(report, output_path)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sher/project/css/semaglutide-reddit-analysis/scripts/utils.py", line 119, in save_json
    json.dump(data, f, indent=2)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 179, in dump
    for chunk in iterable:
                 ^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 433, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 407, in _iterencode_dict
    yield from chunks
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 407, in _iterencode_dict
    yield from chunks
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 440, in _iterencode
    o = _default(o)
  File "/opt/homebrew/Cellar/python@3.13/3.13.6/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type int64 is not JSON serializable

